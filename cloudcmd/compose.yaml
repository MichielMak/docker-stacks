services:
  cloudcmd:
    container_name: cloudcmd
    volumes:
      - ${MEDIA_DIR}:/media
      - ${OVERIG_DIR}:/overig
      - ${DEEMIX_DIR}:/deemix
    image: coderaiser/cloudcmd:19.3.9@sha256:b4f31243098a246a79c79f0888a72c5af0612b71a0ab7154bc1aa95d27dcea1a
    environment:
      - CLOUDCMD_THEME=dark
    labels:
      - homepage.group=Infra
      - homepage.name=Cloudcommander
      - homepage.icon=cloudcmd.png
      - homepage.href=https://cloudcmd.${DOMAIN}/
      - homepage.description=Filemanager
      - traefik.enable=true
      - traefik.http.routers.cloudcmd.rule=Host(`cloudcmd.${DOMAIN}`)
      - traefik.http.routers.cloudcmd.entrypoints=websecure
      - traefik.http.routers.cloudcmd.middlewares=authentik-forwardauth@docker
      - traefik.http.routers.cloudcmd.tls=true
      - traefik.http.services.cloudcmd.loadbalancer.server.port=8000
    restart: unless-stopped
    user: ${PUID}:${PGID}
    networks:
      - npm
networks:
  npm:
    external: true